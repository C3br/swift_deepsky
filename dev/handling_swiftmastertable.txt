In [95]: %history
import pandas as pd
pd.read_csv('4carlos.txt.bkp', delimiter='<|>', header=0)
pd.read_csv('4carlos.txt.bkp', delimiter='<|>', header=1)
df = pd.read_csv('4carlos.txt.bkp', delimiter='<\|>', header=1)
df
help(pd.read_csv)
with open('4carlos.txt.bkp', 'r') as f:
    head = f.readline()
names = head.split()
names
df = pd.read_csv('4carlos.txt.bkp', delimiter='<\|>', skiprows=1, names=names)
df .head()
df = pd.read_csv('4carlos.txt.bkp', delimiter='<\|>', skiprows=1, names=names, index=False)
df = pd.read_csv('4carlos.txt.bkp', delimiter='<\|>', skiprows=1, names=names, index_col=None)
df.head()
len(names)
names=names + ['BLA']
names
df = pd.read_csv('4carlos.txt.bkp', delimiter='<\|>', skiprows=1, names=names)
df.head()
help(pd.read_csv)
help(pd.read_csv)
names.pop()
names
df['PROCESSING_VE'] = df['BLA']
df
df.head()
del df['BLA']
df.head()
df.to_csv('SwiftXrt_master_Apr2018.csv', sep=';', index=None)
df.describe()
df.describe(incluse='all')
df.describe(include='all')
df.applymap(str.strip)
df.describe()
df.describe(include='all')
help(df.applymap)
help(pd.read_csv)
df.tail()
help(pd.read_csv)
pd.to_datetime(df['START_TIME'])
pd.to_datetime(df['START_TIME'].head())
pd.to_datetime(df['START_TIME'].head(), dayfirst=1)
help(df.to_csv)
df.to_csv('SwiftXrt_master_Mar2018.csv', sep=';', index=None, date_format='%DD%MM%YYYY')
df.tail()
dfc = df.copy()
dfc['START_TIME'] = pd.to_datetime(dfc['START_TIME'], dayfirst=True)
dfc.tail()
dfc.to_csv('SwiftXrt_master_Mar2018.csv', sep=';', index=None, date_format='%DD%MM%YYYY')
dfc.to_csv('SwiftXrt_master_Mar2018.csv', sep=';', index=None, date_format='%dd%mm%yyyy')
dfc.to_csv('SwiftXrt_master_Mar2018.csv', sep=';', index=None, date_format='%d/%m/%Y')
dfc['STOP_TIME'] = pd.to_datetime(dfc['STOP_TIME'], dayfirst=True)
dfc.to_csv('SwiftXrt_master_Mar2018.csv', sep=';', index=None, date_format='%d/%m/%Y')
dfc['ARCHIVE_DATE'] = pd.to_datetime(dfc['ARCHIVE_DATE'], dayfirst=True)
dfc.tail()
dfc.to_csv('SwiftXrt_master_Mar2018.csv', sep=';', index=None, date_format='%d/%m/%Y')
dfc.to_csv('SwiftXrt_master_Mar2018.csv', sep=';', index=None, date_format='%d/%m/%Y', float_format='%.5')
dfc.to_csv('SwiftXrt_master_Mar2018.csv', sep=';', index=None, date_format='%d/%m/%Y', float_format='%.5f')
dfc.tail()
pd.to_datetime(dfc['ARCHIVE_DATE'].head(), dayfirst=True)
pd.to_datetime(dfc['ARCHIVE_DATE'].tail(), dayfirst=True)
pd.to_datetime(dfc['ARCHIVE_DATE'].sample(), dayfirst=True)
pd.to_datetime(dfc['ARCHIVE_DATE'].sample(100), dayfirst=True)
pd.to_datetime(dfc['ARCHIVE_DATE'].sample(1000), dayfirst=True)
pd.to_datetime(dfc['ARCHIVE_DATE'].sample(10000), dayfirst=True)
pd.to_datetime(dfc['ARCHIVE_DATE'], dayfirst=True)
dfc['ARCHIVE_DATE'].isnull().any()
dfc['ARCHIVE_DATE'].apply(strip)
dfc['ARCHIVE_DATE'].apply(str.strip)
dfc['ARCHIVE_DATE'].str
dfc['ARCHIVE_DATE'].str.replace('\s+','')
pd.to_datetime(dfc['ARCHIVE_DATE'].str.replace('\s+',''), dayfirst=True)
pd.to_datetime(dfc['ARCHIVE_DATE'].str.replace('\s+',''), dayfirst=True, coerce=True)
pd.to_datetime(dfc['ARCHIVE_DATE'].str.replace('\s+',''), dayfirst=True, errors='coerce')
archive_date = pd.to_datetime(dfc['ARCHIVE_DATE'].str.replace('\s+',''), dayfirst=True, errors='coerce')
anull = archive_date.isnull()
sum(anull)
dfc['ARCHIVE_DATE'].loc[anull]
dfc.loc[anull]
dfc.drop(dfc.loc[anull].index)
dfc
dfc.drop(dfc.loc[anull].index)
dfc.drop(dfc.loc[anull].index, inplace=True)
dfc
pd.to_datetime(dfc['ARCHIVE_DATE'], dayfirst=True)
dfc['ARCHIVE_DATE'] = pd.to_datetime(dfc['ARCHIVE_DATE'], dayfirst=True)
dfc.to_csv('SwiftXrt_master_Mar2018.csv', sep=';', index=None, date_format='%d/%m/%Y', float_format='%.5f')
dfc['ORIG_OBSID'].apply(lambda s:'{:011d}'.format(s))
dfc['ORIG_OBSID'] = dfc['ORIG_OBSID'].apply(lambda s:'{:011d}'.format(s))
dfc['OBSID'] = dfc['OBSID'].apply(lambda s:'{:011d}'.format(s))
dfc.tail()
dfc.applymap(strip)
dfc.applymap(str.strip)
dfc.to_csv('SwiftXrt_master_Mar2018.csv', sep=';', index=None, date_format='%d/%m/%Y', float_format='%.5f')
%history
